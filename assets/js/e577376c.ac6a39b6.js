"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[8505],{3905:function(e,t,n){n.d(t,{Zo:function(){return m},kt:function(){return d}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),c=p(n),d=a,f=c["".concat(l,".").concat(d)]||c[d]||u[d]||o;return n?r.createElement(f,i(i({ref:t},m),{},{components:n})):r.createElement(f,i({ref:t},m))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},8215:function(e,t,n){var r=n(7294);t.Z=function(e){var t=e.children,n=e.hidden,a=e.className;return r.createElement("div",{role:"tabpanel",hidden:n,className:a},t)}},5064:function(e,t,n){n.d(t,{Z:function(){return p}});var r=n(7294),a=n(9443);var o=function(){var e=(0,r.useContext)(a.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},i=n(6010),s="tabItem_1uMI",l="tabItemActive_2DSg";var p=function(e){var t,n=e.lazy,a=e.block,p=e.defaultValue,m=e.values,u=e.groupId,c=e.className,d=r.Children.toArray(e.children),f=null!=m?m:d.map((function(e){return{value:e.props.value,label:e.props.label}})),y=null!=p?p:null==(t=d.find((function(e){return e.props.default})))?void 0:t.props.value,v=o(),g=v.tabGroupChoices,h=v.setTabGroupChoices,k=(0,r.useState)(y),b=k[0],N=k[1],x=[];if(null!=u){var w=g[u];null!=w&&w!==b&&f.some((function(e){return e.value===w}))&&N(w)}var j=function(e){var t=e.currentTarget,n=x.indexOf(t),r=f[n].value;N(r),null!=u&&(h(u,r),setTimeout((function(){var e,n,r,a,o,i,s,p;(e=t.getBoundingClientRect(),n=e.top,r=e.left,a=e.bottom,o=e.right,i=window,s=i.innerHeight,p=i.innerWidth,n>=0&&o<=p&&a<=s&&r>=0)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(l),setTimeout((function(){return t.classList.remove(l)}),2e3))}),150))},z=function(e){var t,n=null;switch(e.key){case"ArrowRight":var r=x.indexOf(e.target)+1;n=x[r]||x[0];break;case"ArrowLeft":var a=x.indexOf(e.target)-1;n=x[a]||x[x.length-1]}null==(t=n)||t.focus()};return r.createElement("div",{className:"tabs-container"},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":a},c)},f.map((function(e){var t=e.value,n=e.label;return r.createElement("li",{role:"tab",tabIndex:b===t?0:-1,"aria-selected":b===t,className:(0,i.Z)("tabs__item",s,{"tabs__item--active":b===t}),key:t,ref:function(e){return x.push(e)},onKeyDown:z,onFocus:j,onClick:j},null!=n?n:t)}))),n?(0,r.cloneElement)(d.filter((function(e){return e.props.value===b}))[0],{className:"margin-vert--md"}):r.createElement("div",{className:"margin-vert--md"},d.map((function(e,t){return(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==b})}))))}},9443:function(e,t,n){var r=(0,n(7294).createContext)(void 0);t.Z=r},6525:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return p},contentTitle:function(){return m},metadata:function(){return u},toc:function(){return c},default:function(){return f}});var r=n(7462),a=n(3366),o=(n(7294),n(3905)),i=n(5064),s=n(8215),l=["components"],p={id:"enzyme",title:"Enzyme",sidebar_label:"Enzyme",description:"Setting up Jest and Enzyme for Typescript Next.js apps"},m=void 0,u={unversionedId:"nextjs/testing/enzyme",id:"nextjs/testing/enzyme",isDocsHomePage:!1,title:"Enzyme",description:"Setting up Jest and Enzyme for Typescript Next.js apps",source:"@site/docs/nextjs/testing/enzyme.md",sourceDirName:"nextjs/testing",slug:"/nextjs/testing/enzyme",permalink:"/superplate/docs/nextjs/testing/enzyme",editUrl:"https://github.com/pankod/superplate/tree/master/documentation/docs/nextjs/testing/enzyme.md",tags:[],version:"current",lastUpdatedBy:"\xd6mer Faruk APLAK",lastUpdatedAt:1620740656,formattedLastUpdatedAt:"5/11/2021",frontMatter:{id:"enzyme",title:"Enzyme",sidebar_label:"Enzyme",description:"Setting up Jest and Enzyme for Typescript Next.js apps"},sidebar:"someSidebar",previous:{title:"Testing Library",permalink:"/superplate/docs/nextjs/testing/testing-library"},next:{title:"Cypress",permalink:"/superplate/docs/nextjs/e2e-testing/cypress"}},c=[{value:"Implementation",id:"implementation",children:[{value:"Jest Setup",id:"jest-setup",children:[]},{value:"Custom Mount",id:"custom-mount",children:[]},{value:"Example Test",id:"example-test",children:[]},{value:"Running Tests",id:"running-tests",children:[]}]},{value:"Adding Enzyme to your project later",id:"adding-enzyme-to-your-project-later",children:[]}],d={toc:c};function f(e){var t=e.components,n=(0,a.Z)(e,l);return(0,o.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://enzymejs.github.io/enzyme/"},"Enzyme")," is a JavaScript Testing utility for React that makes it easier to test your React Components' output. You can also manipulate, traverse, and in some ways simulate runtime given the output."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"superplate"),"'s plugin of Enzyme is built on top of ",(0,o.kt)("a",{parentName:"p",href:"jest"},"superplate's Jest plugin")," and automatically includes necessary wrappers and imports to run your component tests."),(0,o.kt)("h2",{id:"implementation"},"Implementation"),(0,o.kt)("p",null,"You can see how ",(0,o.kt)("strong",{parentName:"p"},"superplate"),"'s Enzyme plugin is implemented below."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Configuration for Jest is not included. Please check out ",(0,o.kt)("a",{parentName:"p",href:"jest"},"Jest Plugin")," to learn more about our Jest configuration."))),(0,o.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Currently, Enzyme is not fully supporting React 17. We will be using ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/wojtekmaj/enzyme-adapter-react-17"},"@wojtekmaj/enzyme-adapter-react-17")," as an adapter for React 17 for compatibility."))),(0,o.kt)("h3",{id:"jest-setup"},"Jest Setup"),(0,o.kt)("p",null,"We need to configure Enzyme with React 17 Adapter in our ",(0,o.kt)("inlineCode",{parentName:"p"},"jest.setup.js")," file. We can do this with following code;"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="test/jest.setup.js"',title:'"test/jest.setup.js"'},'import "isomorphic-unfetch";\nimport nock from "nock";\nimport dotenv from "dotenv";\n// highlight-next-line\nimport Enzyme from "enzyme";\n// highlight-next-line\nimport Adapter from "@wojtekmaj/enzyme-adapter-react-17";\n\ndotenv.config({ path: ".env.test" });\n\n// highlight-next-line\nEnzyme.configure({ adapter: new Adapter() });\n    \nafterAll(() => {\n    nock.cleanAll();\n    nock.restore();\n});\n')),(0,o.kt)("h3",{id:"custom-mount"},"Custom Mount"),(0,o.kt)("p",null,"We may need to wrap our test components to context providers, data stores etc. It's a good practice to make this wrappers globally available. We will create a custom mount function in ",(0,o.kt)("inlineCode",{parentName:"p"},"test/mount.tsx")," file. "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="test/mount.tsx"',title:'"test/mount.tsx"'},'import React, { ReactNode } from "react";\nimport { mount as mountBase, MountRendererProps, ReactWrapper } from "enzyme";\n/*\nimport { ThemeProvider } from \'my-ui-lib\'\nimport { TranslationProvider } from \'my-i18n-lib\'\n*/\n\nexport const AllTheProviders = ({ children }) => {\n    return (\n        // <ThemeProvider theme="light">\n        //     <TranslationProvider>\n                {children}\n        //     </TranslationProvider>\n        // </ThemeProvider>\n    );\n};\n\n\nconst mount: (node: ReactNode, options?: MountRendererProps) => ReactWrapper = (\n    node,\n    options,\n) => {\n    return mountBase(<AllTheProviders>{node}</AllTheProviders>, options);\n};\n\n// override render method\nexport default mount;\n')),(0,o.kt)("h3",{id:"example-test"},"Example Test"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="components/myComponent/index.spec.tsx"',title:'"components/myComponent/index.spec.tsx"'},'// highlight-next-line\nimport mount from "@test/mount"; // <root>/test/mount.tsx\nimport { MyComponent } from "./MyComponent";\n\ndescribe("MyComponent", () => {\n    it("button is clickable", () => {\n        const mockFn = jest.fn();\n        // highlight-next-line\n        const wrapper = mount(<MyComponent onClick={mockFn} />);\n\n        const btn = wrapper.find("button");\n        btn.simulate("click");\n\n        expect(mockFn).toHaveBeenCalledTimes(1);\n    });\n});\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="components/myComponent/index.tsx"',title:'"components/myComponent/index.tsx"'},'import React from "react";\n\nexport const MyComponent: React.FC<{ onClick: () => void }> = ({\n    onClick,\n}) => {\n    return (\n        <div>\n            <button onClick={onClick}>\n                Click Me!\n            </button>\n        </div>\n    );\n};\n')),(0,o.kt)("h3",{id:"running-tests"},"Running Tests"),(0,o.kt)("p",null,"We will use Jest as our test runner. If Jest is already set up you can simply run"),(0,o.kt)(i.Z,{defaultValue:"npm",values:[{label:"npm",value:"npm"},{label:"yarn",value:"yarn"}],mdxType:"Tabs"},(0,o.kt)(s.Z,{value:"npm",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"npm run test\n"))),(0,o.kt)(s.Z,{value:"yarn",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"yarn test\n")))),(0,o.kt)("h2",{id:"adding-enzyme-to-your-project-later"},"Adding Enzyme to your project later"),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"All this work will be handled automatically by superplate, so you don\u2019t need to do anything extra as long as you choose Enzyme as testing plugin during the project creation phase."))),(0,o.kt)("p",null,"If you want to add Enzyme to your existing project first install the dependencies"),(0,o.kt)(i.Z,{defaultValue:"npm",values:[{label:"npm",value:"npm"},{label:"yarn",value:"yarn"}],mdxType:"Tabs"},(0,o.kt)(s.Z,{value:"npm",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"npm install -D enzyme @types/enzyme @wojtekmaj/enzyme-adapter-react-17\n"))),(0,o.kt)(s.Z,{value:"yarn",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"yarn add -D enzyme @types/enzyme @wojtekmaj/enzyme-adapter-react-17\n")))),(0,o.kt)("p",null,"Then you can follow documentations for detail usage"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Enzyme ",(0,o.kt)("a",{parentName:"li",href:"https://enzymejs.github.io/enzyme/"},"documentation")),(0,o.kt)("li",{parentName:"ul"},"Jest setup from ",(0,o.kt)("strong",{parentName:"li"},"superplate")," ",(0,o.kt)("a",{parentName:"li",href:"jest"},"documentation"))))}f.isMDXComponent=!0},6010:function(e,t,n){function r(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(a&&(a+=" "),a+=n);else for(t in e)e[t]&&(a&&(a+=" "),a+=t);return a}function a(){for(var e,t,n=0,a="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(a&&(a+=" "),a+=t);return a}n.d(t,{Z:function(){return a}})}}]);